---
title: å¼€å‘è‡ªå®šä¹‰å·¥å…·
description: å¼€å‘è‡ªå®šä¹‰å·¥å…·
---

## å·¥å…·ï¼ˆToolsï¼‰å®šä¹‰

å·¥å…·ï¼ˆToolsï¼‰å¯ä»¥æ‰©å±• Monkeys å¹³å°çš„èƒ½åŠ›ï¼Œä¸€äº›å¸¸è§çš„ Tools å¦‚ä¸‹ï¼š

- LLM: æä¾›å¤§è¯­è¨€æ¨¡å‹å¯¹è¯çš„èƒ½åŠ›
- çŸ¥è¯†åº“: ä¸º LLM æä¾›çŸ¥è¯†åº“é—®ç­”çš„èƒ½åŠ›
- è‡ªå®šä¹‰ä»£ç : æä¾›è¿è¡Œè‡ªå®šä¹‰ä»£ç çš„èƒ½åŠ›
- ç¿»è¯‘: æä¾›ç¿»è¯‘çš„èƒ½åŠ›
- è¯­éŸ³è¯†åˆ«: æä¾›è¯­éŸ³è¯†åˆ«çš„èƒ½åŠ›
- å›¾åƒç”Ÿæˆ: æä¾›å›¾åƒç”Ÿæˆçš„èƒ½åŠ›
- å°çº¢ä¹¦ã€Twitterã€Instagramã€å¾®åšç­‰ç¤¾äº¤å¹³å°çš„è‡ªåŠ¨åŒ–æ“ä½œ

ç­‰ç­‰ç­‰ç­‰ï¼Œä»»ä½•èƒ½å¤Ÿé€šè¿‡ API è°ƒç”¨çš„æœåŠ¡éƒ½å¯ä»¥ä½œä¸ºä¸€ä¸ª Toolï¼Œé›†æˆåˆ° Monkeys å¹³å°ä¸­ã€‚

## å¦‚ä½•å¼€å‘è‡ªå®šä¹‰ Tool

å¦‚ä¸Šæ–‡æ‰€è¯´ï¼ŒTool å°±æ˜¯ä¸€ä¸ªå¯è¢«è°ƒç”¨çš„ã€æ»¡è¶³ **Swagger** æ ‡å‡†çš„ APIï¼Œé™¤äº†ç¼–å†™ HTTP æ¥å£ä¹‹å¤–ï¼Œä½ ä¸éœ€è¦ä»»ä½•å‰ç½®æŠ€èƒ½ã€‚

ä¹Ÿæ­£å› ä¸ºæ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»ä½•è¯­è¨€å¼€å‘ä½ çš„ Tool.

æ•´ä½“æ¥è¯´ï¼Œå¼€å‘ä¸€ä¸ª Tool éœ€è¦ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

1. ä½¿ç”¨ JSON å®šä¹‰ä½ çš„ Tool.
2. ç¼–å†™ HTTP æ¥å£ï¼Œå®ç°ä½ çš„ Tool é€»è¾‘.
3. éƒ¨ç½²ä½ çš„ Tool.
4. åœ¨ Monkeys å¹³å°ä¸­æ·»åŠ ä½ çš„ Tool.

## ç¤ºä¾‹ï¼šä½¿ç”¨ Python å¼€å‘ä¸€ä¸ªæŸ¥è¯¢å¤©æ°”çš„ Tool

### åˆå§‹åŒ– Python è™šæ‹Ÿç¯å¢ƒ

åˆ›å»º `venv` ç¯å¢ƒï¼Œå¹¶æ¿€æ´»ï¼š

```bash
mkdir monkey-tools-my-awesome-weather-tool
python -m venv venv
source venv/bin/activate
```

### å®‰è£…ä¾èµ–

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ `flask` æ¡†æ¶ï¼Œå¹¶ç”¨ `flask_restx` æ„å»ºæ ‡å‡† Swagger APIã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä»»ä½•å…¶ä»–ä½ å–œæ¬¢çš„æ¡†æ¶ã€‚

```bash
pip install flask flask_restx requests
```

### æ·»åŠ  /manifest.json æ¥å£

`manifest.json` æ¥å£æè¿°äº†ä½ çš„ Tool çš„åŸºæœ¬ä¿¡æ¯ï¼š

- schema_version: å½“å‰ç‰ˆæœ¬å·ï¼Œç›®å‰åªæ”¯æŒ `v1`
- display_name: åœ¨ Monkeys å¹³å°ä¸­æ˜¾ç¤ºçš„åç§°
- namespace: å‘½åç©ºé—´ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„ Toolï¼Œå»ºè®®ä½¿ç”¨ `monkey_tools_` å‰ç¼€ï¼Œå¦‚ `monkey_tools_my_awesome_weather_tool`ã€‚æ­¤å‘½åç©ºé—´å¿…é¡»å…¨å±€å”¯ä¸€ã€‚
- auth: 
  - type: è®¤è¯æ–¹å¼ï¼Œç›®å‰æ”¯æŒ `none` å’Œ `service_http` ä¸¤ç§æ–¹å¼
- api:
  - type: API ç±»å‹ï¼Œç›®å‰åªæ”¯æŒ `openapi`
  - url: Swagger API çš„åœ°å€ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹åœ°å€ï¼Œå¦‚ `/swagger.json`
- contact_email: è”ç³»é‚®ç®±

ç¤ºä¾‹å¦‚ä¸‹ï¼š
    
```json
{
    "schema_version": "v1",
    "display_name": "My Awesome Weather Tool",
    "namespace": "monkey_tools_my_awesome_weather_tool",
    "auth": {"type": "none"},
    "api": {"type": "openapi", "url": "/swagger.json"},
    "contact_email": "dev@inf-monkeys.com",
}
```

åœ¨ Falsk ä¸­ï¼Œåªéœ€è¦åœ¨ `main.py` ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç å³å¯ï¼š

```python
from flask import Flask, request, jsonify
from flask_restx import Api, Resource, fields
import traceback

app = Flask(__name__)
api = Api(
    app,
    version="1.0",
    title="Monkeys Weather API",
    description="Monkeys Weather API",
)

@app.errorhandler(Exception)
def handle_exception(error):
    traceback.print_exc()
    response = {"message": str(error)}
    response["code"] = 500
    print("response", response)
    return jsonify(response), response["code"]


@app.get("/manifest.json")
def get_manifest():
    return {
        "schema_version": "v1",
        "display_name": "My Awesome Weather Tool",
        "namespace": "monkey_tools_my_awesome_weather_tool",
        "auth": {"type": "none"},
        "api": {"type": "openapi", "url": "/swagger.json"},
        "contact_email": "dev@inf-monkeys.com",
    }

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
```

åœ¨å‘½ä»¤ä¸­è¿è¡Œï¼š

```bash
python main.py
```

ä¹‹åï¼Œä½ å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://localhost:5000`ï¼Œå¯ä»¥çœ‹åˆ° Swagger API æ–‡æ¡£å·²ç»è‡ªåŠ¨æ„å»ºå¥½äº†ï¼Œåªä¸è¿‡é‡Œé¢è¿˜æ²¡æœ‰æ¥å£ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹ç¼–å†™å®é™…çš„å¤©æ°”æŸ¥è¯¢æ¥å£ã€‚

![](~/assets/build-tools/example-app-startup.png)

### æ·»åŠ å¤©æ°”æŸ¥è¯¢æ¥å£

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ [https://open-meteo.com/](https://open-meteo.com/) æ¥ä½œä¸ºå¤©æ°”æŸ¥è¯¢çš„ APIã€‚

æ³¨æ„ä»¥ä¸‹ä»£ç ä¸­çš„:
- `@weather_ns.vendor` æ³¨è§£ï¼Œè¿™æ˜¯ Monkeys å¹³å°çš„æ‰©å±•ï¼Œç”¨äºæè¿° Tool çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚è¾“å…¥ã€è¾“å‡ºã€ä¼°è®¡è€—æ—¶ç­‰ã€‚
- `@weather_ns.expect` æ³¨è§£ï¼Œç”¨äºæè¿°è¾“å…¥å‚æ•°
- `@weather_ns.response` æ³¨è§£ï¼Œç”¨äºæè¿°è¾“å‡ºå‚æ•°

```python
import requests
weather_ns = api.namespace("weather", description="Weather API")

@weather_ns.route("/")
class WeatherLookUpResource(Resource):
    @weather_ns.doc("get_weather")
    @weather_ns.vendor(
        {
            "x-monkey-tool-name": "get_weather",
            "x-monkey-tool-categories": ["weather"],
            "x-monkey-tool-display-name": "Get Weather",
            "x-monkey-tool-description": "Get Weather By Latitude and Longitude",
            "x-monkey-tool-icon": "emoji:ğŸ’¿:#e58c3a",
            "x-monkey-tool-input": [
                {
                    "displayName": "Latitude",
                    "name": "latitude",
                    "type": "number",
                    "required": True,
                },
                {
                    "displayName": "Longitude",
                    "name": "longitude",
                    "type": "number",
                    "required": True,
                }
            ],
            "x-monkey-tool-output": [
               {
                "displayName": "Latitude",
                "name": "latitude",
                "type": "number",
               },
               {
                "displayName": "Longitude",
                "name": "longitude",
                "type": "number",
               },
               {
                "displayName": "Generation Time",
                "name": "generationtime_ms",
                "type": "number",
               },
               {
                "displayName": "UTC Offset",
                "name": "utc_offset_seconds",
                "type": "number",
               },
               {
                "displayName": "Timezone",
                "name": "timezone",
                "type": "string",
               },
               {
                "displayName": "Timezone Abbreviation",
                "name": "timezone_abbreviation",
                "type": "string",
               },
               {
                "displayName": "Elevation",
                "name": "elevation",
                "type": "number",
               },
               {
                "displayName": "Current Units",
                "name": "current_units",
                "type": "object",
               },
               {
                "displayName": "Current",
                "name": "current",
                "type": "object",
               },
               {
                "displayName": "Hourly Units",
                "name": "hourly_units",
                "type": "object",
               },
               {
                "displayName": "Hourly",
                "name": "hourly",
                "type": "object",
               }
            ],
            "x-monkey-tool-extra": {
                "estimateTime": 5,
            },
        }
    )
    @weather_ns.expect(
        weather_ns.model(
            "GetWeatherRequest",
            {
                "latitude": fields.Float(required=True, description="Latitude"),
                "longitude": fields.Float(required=True, description="Longitude"),
            },
        )
    )
    @weather_ns.response(
        200,
        "Success",
        weather_ns.model(
            "GetWeatherResult",
            {
                "latitude": fields.Float(description="Latitude"),
                "longitude": fields.Float(description="Longitude"),
                "generationtime_ms": fields.Float(description="Generation Time"),
                "utc_offset_seconds": fields.Integer(description="UTC Offset"),
                "timezone": fields.String(description="Timezone"),
                "timezone_abbreviation": fields.String(description="Timezone Abbreviation"),
                "elevation": fields.Float(description="Elevation"),
                "current_units": fields.Nested(
                    weather_ns.model(
                        "CurrentUnits",
                        {
                            "time": fields.String(description="Time"),
                            "interval": fields.String(description="Interval"),
                            "temperature_2m": fields.String(description="Temperature 2m"),
                            "wind_speed_10m": fields.String(description="Wind Speed 10m"),
                        },
                    )
                ),
                "current": fields.Nested(
                    weather_ns.model(
                        "Current",
                        {
                            "time": fields.String(description="Time"),
                            "interval": fields.Integer(description="Interval"),
                            "temperature_2m": fields.Float(description="Temperature 2m"),
                            "wind_speed_10m": fields.Float(description="Wind Speed 10m"),
                        },
                    )
                ),
                "hourly_units": fields.Nested(
                    weather_ns.model(
                        "HourlyUnits",
                        {
                            "time": fields.String(description="Time"),
                            "temperature_2m": fields.String(description="Temperature 2m"),
                            "relative_humidity_2m": fields.String(description="Relative Humidity 2m"),
                            "wind_speed_10m": fields.String(description="Wind Speed 10m"),
                        },
                    )
                ),
                "hourly": fields.Nested(
                    weather_ns.model(
                        "Hourly",
                        {
                            "time": fields.List(fields.String, description="Time"),
                            "temperature_2m": fields.List(fields.Float, description="Temperature 2m"),
                            "relative_humidity_2m": fields.List(fields.Integer, description="Relative Humidity 2m"),
                            "wind_speed_10m": fields.List(fields.Float, description="Wind Speed 10m"),
                        },
                    )
                ),
            },
        ),
    )
    def get(self):
        """
        Example output:
{
    "latitude": 52.52,
    "longitude": 13.419998,
    "generationtime_ms": 0.1291036605834961,
    "utc_offset_seconds": 0,
    "timezone": "GMT",
    "timezone_abbreviation": "GMT",
    "elevation": 38.0,
    "current_units": {
        "time": "iso8601",
        "interval": "seconds",
        "temperature_2m": "Â°C",
        "wind_speed_10m": "km/h"
    },
    "current": {
        "time": "2024-04-12T10:15",
        "interval": 900,
        "temperature_2m": 17.5,
        "wind_speed_10m": 16.4
    },
    "hourly_units": {
        "time": "iso8601",
        "temperature_2m": "Â°C",
        "relative_humidity_2m": "%",
        "wind_speed_10m": "km/h"
    },
    "hourly": {
        "time": [
            "2024-04-12T00:00",
            "2024-04-12T01:00",
            "2024-04-12T02:00",
            "2024-04-12T03:00",
            "2024-04-12T04:00",
            "2024-04-12T05:00",
        ],
        "temperature_2m": [
            13.1,
            12.9,
            12.6,
            12.9,
            12.8,
            12.9,
        ],
        "relative_humidity_2m": [
            78,
            80,
            82,
            81,
            81,
            81,
        ],
        "wind_speed_10m": [
            3.6,
            5.9,
            7.2,
            7.7,
            7.4,
            6.4,
        ]
    }
}
        """
        json = request.json
        latitude = json.get("latitude")
        longitude = json.get("longitude")
        api = f"https://api.open-meteo.com/v1/forecast?latitude={latitude}&longitude={longitude}&current=temperature_2m,wind_speed_10m&hourly=temperature_2m,relative_humidity_2m,wind_speed_10m"
        r = requests.get(api)
        return r.json()

```

é‡å¯æœåŠ¡ï¼Œä½ å¯ä»¥åœ¨ Swagger API æ–‡æ¡£ä¸­çœ‹åˆ°ä½ çš„æ¥å£å·²ç»æ·»åŠ æˆåŠŸäº†ã€‚

![](~/assets/build-tools/example-app-api.png)

### å¯¼å…¥ Monkeys å¹³å°

å°† Tools å¯¼å…¥åˆ° Monkeys å¹³å°ï¼Œä½ åªéœ€è¦å¡«å…¥ Manifest JSON çš„åœ°å€å³å¯ï¼Œè¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬çš„åœ°å€æ˜¯ `http://localhost:5000/manifest.json`ã€‚

![](~/assets/build-tools/example-app-import.png)

å¯¼å…¥æˆåŠŸä¹‹åï¼Œä½ åº”è¯¥å¯ä»¥åœ¨ Monkeys å¹³å°ä¸­çœ‹åˆ°ä½ çš„ Tool äº†ã€‚

![](~/assets/build-tools/get-weather-tool.png)

æ‰§è¡Œå·¥ä½œæµï¼Œå¯ä»¥çœ‹åˆ°ä½ çš„ Tool å·²ç»è¢«æˆåŠŸè°ƒç”¨äº†ã€‚

![](~/assets/build-tools/workflow-result.png)
